import requests
import string

def oracle(plaintext):
    url = f"https://aes.cryptohack.org/ecb_oracle/encrypt/{plaintext.hex()}/"
    # print("URL: ", url)
    r = requests.get(url)
    ciphertext = r.json()['ciphertext']
    return ciphertext

guessed = b'crypto{p3n6u1n5_'
second_part = b'6u1n5_h473_3cb}'

for i in range(16):
    for c in string.printable:
        plaintext = guessed[1 + len(second_part):16] + second_part + c.encode() + b'X' * (15 - len(second_part))
        print(plaintext)
        ciphertext = oracle(plaintext)
        print(ciphertext[0:32], ciphertext[64:96])
        if ciphertext[0:32] == ciphertext[64:96]:
            print(second_part, c)
            second_part += c.encode()
            break

print("second_part: ", second_part)