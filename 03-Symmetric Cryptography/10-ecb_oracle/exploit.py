import requests
import string

def oracle(plaintext):
    url = f"https://aes.cryptohack.org/ecb_oracle/encrypt/{plaintext.hex()}/"
    # print("URL: ", url)
    r = requests.get(url)
    ciphertext = r.json()['ciphertext']
    return ciphertext

guessed = b'crypto{p3n6u1n5_'

for i in range(16):
    for c in string.printable:
        plaintext = b'X' * (15 - len(guessed)) + guessed + c.encode() + b'X' * (15 - len(guessed))
        print(plaintext)
        ciphertext = oracle(plaintext)
        print(ciphertext[0:32], ciphertext[32:64])
        if ciphertext[0:32] == ciphertext[32:64]:
            print(guessed, c)
            guessed += c.encode()
            break

print("GUESSED: ", guessed)