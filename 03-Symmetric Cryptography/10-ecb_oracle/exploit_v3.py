import requests
import string

def oracle(plaintext):
    url = f"https://aes.cryptohack.org/ecb_oracle/encrypt/{plaintext.hex()}/"
    r = requests.get(url)
    j = r.json()
    ciphertext = j['ciphertext']
    return ciphertext

flag = b'crypto{p3n6u1n5_6u1n5_h473_3cb'

while len(flag) < 32:
    padding = b'X' * (31 - len(flag))

    for c in range(256):
        plaintext = padding + flag + chr(c).encode() + padding
        print("PLAINTEXT: ", plaintext[:32], plaintext[32:])
        ciphertext = oracle(plaintext)
        if ciphertext[0:64] == ciphertext[64:128]:
            flag += chr(c).encode()
            break
    

print("FLAG: ", flag)